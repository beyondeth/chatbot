<!DOCTYPE html>
<html>
<head>
    <title>ì¹´ì¹´ì˜¤ë´‡ í…ŒìŠ¤íŠ¸</title>
    <meta charset="utf-8">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; }
        input, button { width: 100%; padding: 10px; margin: 5px 0; }
        #result { background: #f0f0f0; padding: 15px; margin-top: 20px; border-radius: 5px; white-space: pre-wrap; }
        .loading { color: #666; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤– ì¹´ì¹´ì˜¤ë´‡ ë¡œì»¬ í…ŒìŠ¤íŠ¸</h1>
        
        <h3>í…ŒìŠ¤íŠ¸ URL ì…ë ¥</h3>
        <input type="text" id="urlInput" placeholder="ìœ íŠœë¸Œ ë˜ëŠ” ë‰´ìŠ¤ URL ì…ë ¥..." 
               value="https://www.youtube.com/watch?v=dQw4w9WgXcQ">
        
        <button onclick="testSummary()">ìš”ì•½ í…ŒìŠ¤íŠ¸</button>
        
        <div id="result"></div>
        
        <h3>ì˜ˆì‹œ ë§í¬</h3>
        <ul>
            <li><a href="#" onclick="setUrl('https://www.youtube.com/watch?v=dQw4w9WgXcQ')">ìœ íŠœë¸Œ ì˜ˆì‹œ</a></li>
            <li><a href="#" onclick="setUrl('https://n.news.naver.com/article/001/0014994526')">ë„¤ì´ë²„ ë‰´ìŠ¤ ì˜ˆì‹œ</a></li>
        </ul>
    </div>

    <script>
        function setUrl(url) {
            document.getElementById('urlInput').value = url;
            return false;
        }
        
        async function testSummary() {
            const url = document.getElementById('urlInput').value;
            const resultDiv = document.getElementById('result');
            
            if (!url) {
                resultDiv.innerHTML = '<span class="error">URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”!</span>';
                return;
            }
            
            resultDiv.innerHTML = '<span class="loading">ğŸ”„ ìš”ì•½ ì¤‘...</span>';
            
            try {
                const response = await fetch('http://localhost:3000/chat/process', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        roomId: 'test-room',
                        message: url
                    })
                });
                
                const data = await response.json();
                
                if (data.summary) {
                    // ë©”ì‹ ì €ë´‡Rê³¼ ë™ì¼í•œ í¬ë§·íŒ… ì ìš©
                    let formatted = data.summary;
                    formatted = formatted.replace(/<p>/g, "â€¢ ");
                    formatted = formatted.replace(/<\/p>/g, "\n");
                    formatted = formatted.replace(/<[^>]*>/g, "");
                    formatted = formatted.replace(/\n\s*\n/g, "\n");
                    
                    const isYoutube = url.includes('youtube.com') || url.includes('youtu.be');
                    const icon = isYoutube ? "ğŸ¥" : "ğŸ“°";
                    const type = isYoutube ? "ìœ íŠœë¸Œ" : "ë‰´ìŠ¤";
                    
                    resultDiv.innerHTML = `<span class="success">${icon} ${type} ìš”ì•½</span>\n\n${formatted.trim()}`;
                } else {
                    resultDiv.innerHTML = '<span class="error">âŒ ìš”ì•½ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</span>';
                }
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">âš ï¸ ì˜¤ë¥˜: ${error.message}</span>`;
            }
        }
    </script>
</body>
</html>